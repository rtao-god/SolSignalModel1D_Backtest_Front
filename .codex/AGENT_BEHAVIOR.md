# Правила работы агента (Frontend)

## Область действия
- Если задача только про фронт/вёрстку/UX — работаю только в `SolSignalModel1D_Backtest_Front` и читаю только его `.codex`.
- Если задача затрагивает API/контракты/совместные изменения — читаю `.codex` фронта и бэкенда.

## Навигация по проекту
- Перед вопросами сначала ищу в проекте (`rg` + просмотр файлов).
- Использую alias `@` для импортов из `src`.

## UI и логика
- Сначала переиспользую `shared/ui` и `widgets`, не создаю дубли.
- Если компонент может быть переиспользован — поднимаю его в `shared/ui`.
- Не добавляю фиктивные данные/моки “для компиляции”.

## Правило комментариев для .ts и .tsx файлов:
1) Общие требования

Комментарии пишу только там, где они реально добавляют смысл (неочевидная логика, контракты, инварианты, причины решений). Если полезного добавить нечего — комментарий не нужен. Если комментарий нужен, пишу его по‑русски (англ. термины можно).

В неочевидных местах (логика, инварианты, причины решений, компромиссы, зависимость от контракта данных/формата) — комментировать детально.

В остальных местах — тоже подробные (но при этом не мусорные) комментарии без ненужных объяснений.

2) Когда использовать //

Используй //, если комментарий укладывается в 1 строку и в нём нет подпунктов.

Формат:

1–2 коротких предложения через точку.

Без “воды”, без детских пояснений.

Пример:

// Пропсы верхнего компонента. className — опциональный внешний класс.


Ещё пример с одним подпунктом:

// Пропсы карточки-таблицы: рендер одной TableSectionDto.

3) Когда использовать /* ... */

Используй /* ... */, если:

нужно 2+ строк, или

есть структура (заголовки/более одного подпункта), или
важны контракты/инварианты/риски/мотивация, которые нельзя уместить в одну строку.

Стиль внутри /* ... */ (строго)

Внутри:
Первая строка — название/роль без маркера -. В название/роль нужно как можно подробнее написать о чем этот компонент. А именно что делает, как и что вообще есть сейчас в этом компоненте (и рядом с ним, если он декомпозирован), чтобы видеть всю картину целиком. Но при этом разбовлять водой комментарий нельзя, только по делу писать, без ненужных прилагательны (по типу "хороший компонент"). 

Далее разделы вида Зачем:, Контракты,инварианты:, Источники данных и сайд-эффекты:, Риски:, Public API:  (только нужные). 
- Раздел "Зачем: " нужно писать только в главном комментарии в файле. В обычных комментариях писать раздел "Зачем: подпункты" НЕ нужно, нужно сразу переходить к делу (подпунктам).
- После каждого раздела поставить пустую строку, чтобы читать было легче. 
 - Public API писать ТОЛЬКО если экспортов несколько или API неочевиден. Если в файле только default export и это очевидно — раздел Public API НЕ писать.

Под каждым разделом подпункты обязательно с - .
Табуляция/отступы обязательны:
Раздел (Зачем: ) — с отступом 1 уровень.
Подпункты (- ...) — с отступом 2 уровня.

Эталол стиля главного комментария (который идет после всех импортов обычно):
/*
	ModelStatsPage — UI для просмотра отчёта “Статистика моделей”, которая в себя включает: (перечисление по пунктам, без бреда и мусорной информации, которая и так очевидна и не помогает).

	Зачем:
		- Даёт юзеру обзор качества/поведения ML-моделей по сегментам данных (OOS / Train / Full / Recent).
		- Даёт переключатели сегмента и режима (business vs technical) и навигацию по секциям отчёта.

	Источники данных и сайд-эффекты:
		- Данные: useModelStatsReportQuery() (tanstack query).
		- Инициализация сегмента: useEffect выбирает стартовый сегмент из доступных.
		- Навигация по секциям: useSectionPager({ syncHash: true }) синхронизирует текущую секцию с hash.

	Контракты:
		- ModelStatsPageInner получает только валидный data (null/ошибки/ретраи — обязанность boundary).
		- Сегменты определяются по префиксам в section.title вида “[OOS] ” и т.п. (контракт формата отчёта).
*/

Пример (локальный блок для типа/константы)

Если есть 1 тезис — //.
Если есть тезис + пояснение/подпункты — /* ... */.

- Пример обычного комментария /* ... */ (есть подпункты):

/*
	Пропсы карточки-таблицы.

	- Рендер одной TableSectionDto.
	- domId используется для стабильного якоря (hash/scroll) и aria-labelledby (связь section ↔ заголовок).
*/

- Пример // (если остаётся только первый тезис):
// Пропсы карточки-таблицы: рендер одной TableSectionDto.

4) В главном комментарии не должно быть очевидных вещей, по типу "BacktestSummaryReportPage — пропсы страницы сводки бэктеста. Зачем:
		- Фиксирует контракт входных props страницы." - это и так понятно, а значит и писать это не нужно такие банальные вещи в комментариях. Комментарии должны быть умными и реально полезными. Если полезного ничего написать не получается (потому что в файлы, например, types.ts у каждого компонента реально можно ничего не писать, так как там и так все очевидно, скорее всего) - значит комментарий оставлять не нужно вовсе. 

## Правила для .scss комментарией: 
- В файлах .scss комментарии писать только там, где они реально помогают ориентироваться в стилях. Главные комментарии и формальные заголовки в scss не нужны.
- Писать поменьше ненужных прилагательных и прочего шума, если можно без них и смысл останется прежним. Пример: вместо     // Немного ограничиваем ширину на очень широких мониторах,
    // чтобы таблицы не растягивались бесконечно.
    max-width: 1400px;
    margin: 0 auto;

    лучше написать:     // Ограничиваем ширину на широких мониторах,
    // чтобы таблицы не растягивались.
    max-width: 1400px;
    margin: 0 auto;

- Так же в scss файлах можно делать при помощи комментарией и отступов на логические блоки, чтобы было легче программисту ореинтироваться по стилям в файле. Пример: /* Шапка отчёта */

## Уточнения для всех комментариев в коде: 
- Иногда лучше просто ничего не писать в комментарий (например, заголовок или что-нибудь еще) и сразу переходить к делу, чем писать заголовок не ради помощи программисту с ореинтацией в коде, а просто потому что так написано в инструкции. От инструкции можно и нужно отходить во благу здравого смысла. Значит, можно не писать комментарий вообще, если этого не требует здравый смысл. 
- Комментарий должен быть полезным, а не мусорным текстом ради текста.
- Если инструкция/ТЗ допускают двоякое толкование или противоречат друг другу — сначала останавливаюсь и уточняю ожидаемую реализацию/приоритеты, а не додумываю.
- В файлах по типу types.ts, который есть обычно у каждого компонента - не писать главные там комментарии, потому что они там обычно не нужны. Но если файл все же чуть сложнее, чем кажется - написать комментарий, но не главный, а обычный. Главный тоже можно, если это прям нужно.

- Важно: Писать комментарии по типу "// Пропсы страницы истории прогнозов.
interface PredictionHistoryPageProps {
    className?: string
}" и "SectionPager — UI модуль. Зачем:
		- Инкапсулирует UI-компонент или вспомогательные типы." - НЕ надо, потому что это МУСОРНЫЕ комментарии и тупые по своей сути. Вместо них обязаны быть нормальные, подрорбные, без мусора и лишней информации, комментарии, главный комментарий и обычный (и да, это касается лишь для .tsx файлов и некоторых .ts файлов) (там, где интерфейс, обычно не нужен вообще главный комментарий и вообще какой-либо комментарий, ТОЛЬКО если это не мусорный комментарий. Там, где всякие константы и прочее - комментарий нужен, обычно, но без бреда и мусорной информации, которая и так понятна и видна с первого взгялда. В комментариях не должно быть каких-то лишних слов ради слов) 
        - Проще говоря: комментарии должны быть только там, где им место. Писать тупой комментарий, который тупо не нужен какому-то файлу - НЕ нужно - это ошибка. 
        
        
Структура и правила файлов при создании компонентов обычно такая:
- Если файл имеет больше 350 строк, то нужно подумать об его декомпозиции, чтобы строчек кода стало меньше 350-400 (но некоторым файлам декомпозиция не нужна, их можно оставить и с больше 400 строчками кода). 

- Формат обычного компонента такой: отдельный module.scss файл, отдельный types.ts рядом с компонентом. Если компонент лежит в `ui`, то `types.ts` лежит в той же `ui` папке рядом с `*.tsx`. Поднимать `types.ts` выше — только если есть явная причина.

- Пример структуры папок (обычные компоненты, для каких-то особенных/других компонентов можно спокойно отойти от структуры): pages/predictions/ui/CurrentMLModelPredictionPage/ui/CurrentMLModelPredictionPage.tsx. Ts файл с интерфейсом находится в pages/predictions/ui/CurrentMLModelPredictionPage/ui/types.ts. Пример содержимого файла: export default interface CurrentMLModelPredictionProps {
    className?: string
}

(и да, className нужно всегда писать в каждый компонент, чтобы в будущем мы могли сразу использовать className извне в виде пропса. Даже если сейчас компонент не использует его - оставить/добавить, в будущем пригодится, скорее всего)

- index.ts добавляю только если он реально сокращает импорты или нужен как внешний API. По умолчанию реэкспортирую только default export. Типы реэкспортирую ТОЛЬКО если они реально используются вне папки (перед добавлением проверяю `rg`).

- Стараться писать default импорты (если это, конечно, стандартно для какого-то компонента, воспринимать буквально эту инструкцию, как и другие, НЕ надо). 

- По дефолту стили и компоненты должны быть современными (красивыми, технологичными, с красивыми градиентами/анимациями) и с подробными-диагностическими логами об ошибках, если что-то пошло не так на какой-то стадии загрузки страницы. Так же должна быть адаптивность под разные экраны (сначала мы делаем пк версию компонента, а потом адаптируем под телефоны/планшеты).

- Папки Quantower, ImpulseScanner и BTC-Project игнорируй - эти папки к проекту не относятся. 
